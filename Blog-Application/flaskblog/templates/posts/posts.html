{% extends 'base.html'%}
{% block content %}
{% for message in get_flashed_messages() %}
<div class="alert alert-success alert-dismissible fade show" role="alert">
  {{message}}
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
{% endfor %}
{% for post in posts %}
<br>
<div class="container my-4">
<div class="card" style="width: 18rem;">
  <div class="card-body">
    <h5 class="card-title"><a href="{{url_for('blog.post',id = post.id)}}">{{post.title}}</a></h5>
    <ul class="list-group list-group-flush">
      <li class="list-group-item">By: {{post.poster.name}}</li>
      <li class="list-group-item">{{post.date_posted}}</li>
    </ul>
    </p>
    <a href="{{url_for('blog.post',id = post.id)}}" class='btn btn-outline-secondary btn-sm'>View Post</a>
    {% if post.poster.id == current_user.id%}
    <a href="{{url_for('blog.edit_post',id = post.id)}}" class='btn btn-outline-secondary btn-sm'>Edit Post</a>
    <a href="{{url_for('blog.delete_post',id = post.id)}}" class='btn btn-outline-danger btn-sm'>Delete Post</a>
    {% endif %}
</div>
</div>
</div>
{% endfor %}

<!-- Pagination Controls -->
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    {% if posts.has_prev %}
    <li class="page-item">
      <a class="page-link" href="{{ url_for('blog.posts', page=posts.prev_num) }}">Previous</a>
    </li>
    {% else %}
    <li class="page-item disabled">
      <span class="page-link">Previous</span>
    </li>
    {% endif %}

    {% for page_num in posts.iter_pages() %}
    {% if page_num %}
    {% if page_num == posts.page %}
    <li class="page-item active">
      <span class="page-link">{{ page_num }}</span>
    </li>
    {% else %}
    <li class="page-item">
      <a class="page-link" href="{{ url_for('blog.posts', page=page_num) }}">{{ page_num }}</a>
    </li>
    {% endif %}
    {% else %}
    <li class="page-item disabled">
      <span class="page-link">...</span>
    </li>
    {% endif %}
    {% endfor %}

    {% if posts.has_next %}
    <li class="page-item">
      <a class="page-link" href="{{ url_for('blog.posts', page=posts.next_num) }}">Next</a>
    </li>
    {% else %}
    <li class="page-item disabled">
      <span class="page-link">Next</span>
    </li>
    {% endif %}
  </ul>
</nav>

{% endblock %}